package saborea.presentation.vista;

import javax.swing.table.DefaultTableModel;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.border.EmptyBorder;
import javax.swing.plaf.basic.BasicTabbedPaneUI.TabbedPaneLayout;

import saborea.model.bussiness.ProductoBussiness;
import saborea.model.bussiness.DTO.CredencialesBE;
import saborea.model.bussiness.DTO.ListaProductosBE;
import saborea.model.bussiness.DTO.VwRegistroPedidoProductoBE;

import javax.swing.JLabel;
import javax.swing.JTextField;
import java.awt.Font;
import javax.swing.JTable;
import javax.swing.JCheckBox;
import javax.swing.JCheckBoxMenuItem;
import javax.swing.JComboBox;
import javax.swing.JButton;
import javax.swing.DefaultComboBoxModel;
import java.awt.Choice;
import java.awt.Container;
import java.awt.Event;
import java.awt.EventQueue;
import java.awt.List;
import java.awt.Checkbox;
import java.awt.Scrollbar;
import javax.swing.JSpinner;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;
import java.awt.Point;
import javax.swing.JScrollPane;
import java.awt.event.MouseListener;
import java.util.ArrayList;
import java.awt.event.MouseEvent;


public class FormRegistrarPedido extends JFrame implements ActionListener , MouseListener{

	private JPanel contentPane;	
	private Container contenedor;
	private VwRegistroPedidoProductoBE obj;
	Tabla t;
	//
//	DefaultTableModel model= new DefaultTableModel(){
//		public boolean isCellEditable(int row, int column) {
//			if(column==2){
//				return true;
//			}else{
//				return false;
//			}
//		};
//	};
	
	private JScrollPane scrollPane;
	private JTable table;
	private JButton btnSave;
	private JButton btnEnviarOrdenA;
	private JButton btnBack;
	private JLabel lblOrdenDePedido;
	private JLabel lblDetalleDePedido;
	private JLabel lblDniCliente;
	private JLabel lblCliente;
	private JTextField txtClienteDNI_pedido;
	private JLabel lblMozo;
	private JLabel lblNMesa;
	private JLabel lblNommozo;
	private JLabel lblIDMESA;
	private JLabel LblnomCliente;
	private JButton btnAgregarProducto;
	private JLabel lblNewLabel;
	private JLabel lblTotalPagar;
	//private JLabel lblTotalPagar;
//	static double TotalPagar;
//	double subtotal;
	
	
	
//	protected void do_scrollPane_mouseClicked(java.awt.event.MouseEvent evt) {
//		System.out.println("ENTRO A MOUSECLICKED");
//		//private void tableMouseClicked (java.awt.event.MouseEvent evt) {
//			
//			//PARA OBTENER LA POSICIÓN DONDE DAMOS CLICK x and y 
//			int column=table.getColumnModel().getColumnIndexAtX(evt.getX());
//			int row= evt.getY()/table.getRowHeight();
//			 
//			if(row<table.getRowCount() && row>=0 && column<table.getColumnCount() && column>=0){
//				
//				Object value = table.getValueAt(row, column);
//				
//				if(value instanceof JButton){
//					//si doy click al button
//					((JButton)value).doClick();
//					//devolvemos la acción
//					JButton btn= (JButton) value;
//					
//					System.out.println("Click en el button");
//					
//				}
//				
//				
//				
//			}
//			
//			
//			
//		}
		
	
	/**
	 * Launch the application.
	 */
//	public static void main(String[] args) {
//		EventQueue.invokeLater(new Runnable() {
//			public void run() {
//				try {
//					FormRegistrarPedido frame = new FormRegistrarPedido(obj);
//					frame.setVisible(true);
//				} catch (Exception e) {
//					e.printStackTrace();
//				}
//			}
//		});
//	}

	/**
	 * Create the frame.
	 */
	
//	public FormRegistrarPedido(){
//		table = new JTable();
//		scrollPane.setViewportView(table);
//		
//		System.out.println("mostrar columnas");
//		model.addColumn("NOMBRE");
//		model.addColumn("PRECIO");
//	}
	
	
	
	public FormRegistrarPedido(VwRegistroPedidoProductoBE obj) {		
		
//		TotalPagar=0.00;
//		subtotal=0.00;
		
		contenedor=getContentPane();
		contenedor.setLayout(null);
		        //Asigna un titulo a la barra de titulo
		 setTitle("VENTANA ORDEN DE PEDIDO");
		//tamaño de la ventana
		setSize(900,800);
		setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		setBounds(300, 300, 980, 980);	
		
		
		contentPane = new JPanel();
		contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
		setContentPane(contentPane);
		contentPane.setLayout(null);
		
		scrollPane = new JScrollPane();
		scrollPane.addMouseListener(this);
		scrollPane.setBounds(25, 352, 914, 393);
		contentPane.add(scrollPane);
		
		table = new JTable();
		table.addMouseListener(this);
		scrollPane.setViewportView(table);
		
//		
//		System.out.println("mostrar columnas");
//		model.addColumn("NOMBRE");
//		model.addColumn("PRECIO");
//		model.addColumn("CANTIDAD");
//		table.setModel(model);
		
		t= new Tabla();
		
		btnSave = new JButton("SAVE");
		btnSave.setBounds(620, 893, 89, 23);
		contentPane.add(btnSave);
		
		btnEnviarOrdenA = new JButton("ENVIAR ORDEN A CAJA");
		btnEnviarOrdenA.setBounds(766, 893, 173, 23);
		contentPane.add(btnEnviarOrdenA);
		
		btnBack = new JButton("BACK");
		btnBack.setBounds(10, 893, 89, 23);
		contentPane.add(btnBack);
		
		lblOrdenDePedido = new JLabel("ORDEN DE PEDIDO");
		lblOrdenDePedido.setBounds(31, 11, 230, 14);
		contentPane.add(lblOrdenDePedido);
		
		lblDetalleDePedido = new JLabel("DETALLE DE PEDIDO");
		lblDetalleDePedido.setBounds(10, 307, 109, 14);
		contentPane.add(lblDetalleDePedido);
				
		
		btnAgregarProducto = new JButton("AGREGAR PRODUCTO");
		btnAgregarProducto.addActionListener(this);
		btnAgregarProducto.setBounds(774, 307, 165, 23);
		contentPane.add(btnAgregarProducto);
		
		lblDniCliente = new JLabel("DNI CLIENTE :");
		lblDniCliente.setBounds(31, 56, 69, 14);
		contentPane.add(lblDniCliente);
		
		lblCliente = new JLabel("CLIENTE:");
		lblCliente.setBounds(31, 92, 89, 14);
		contentPane.add(lblCliente);
		
		lblMozo = new JLabel("MOZO :");
		lblMozo.setBounds(490, 56, 69, 14);
		contentPane.add(lblMozo);
		
		lblNMesa = new JLabel("N\u00B0 MESA :");
		lblNMesa.setBounds(490, 92, 69, 14);
		contentPane.add(lblNMesa);
		
		txtClienteDNI_pedido = new JTextField();
		txtClienteDNI_pedido.setBounds(118, 53, 109, 20);
		contentPane.add(txtClienteDNI_pedido);
		txtClienteDNI_pedido.setColumns(10);
		
		lblNewLabel = new JLabel("TOTAL PAGAR : S/ ");
		lblNewLabel.setBounds(488, 774, 123, 14);
		contentPane.add(lblNewLabel);
		
		lblTotalPagar = new JLabel("");
		lblTotalPagar.setBounds(606, 774, 123, 14);
		contentPane.add(lblTotalPagar);
		
		
		
		
		//obj=null;
		
		if(obj==null){//registro nuevo 
			t.seeTable(table, obj);
			lblTotalPagar.setText("0.00");
			
			
		}else if(obj.isEnable()){//todos los permisos
						
			t.seeTable(table, obj);			
			lblTotalPagar.setText(""+ obj.getTotal());
			
			txtClienteDNI_pedido.setText(""+obj.getDniCliente());			
			
			//nombre cliente api reniec
			LblnomCliente = new JLabel("gaaa");
			LblnomCliente.setBounds(118, 92, 123, 14);
			contentPane.add(LblnomCliente);
			
			lblNommozo = new JLabel(obj.getNombreMozo()+" "+obj.getApellidoMozo());
			lblNommozo.setBounds(558, 56, 123, 14);
			contentPane.add(lblNommozo);
			
			lblIDMESA = new JLabel(""+obj.getCodMesa());
			lblIDMESA.setBounds(558, 92, 123, 14);
			contentPane.add(lblIDMESA);			
			
			
			
			
		}else {//si el empleado no atiende esa mesa
			
			t.seeTable(table, obj);			
			
			lblTotalPagar.setText(""+ obj.getTotal());
			lblTotalPagar.setEnabled(false);
			
			txtClienteDNI_pedido.setText(""+obj.getDniCliente());
			txtClienteDNI_pedido.setEnabled(false);
			
			//nombre cliente api reniec
			LblnomCliente = new JLabel("gaaa");
			LblnomCliente.setBounds(118, 92, 123, 14);
			contentPane.add(LblnomCliente);
			
			lblNommozo = new JLabel(obj.getNombreMozo()+" "+obj.getApellidoMozo());
			lblNommozo.setBounds(558, 56, 123, 14);
			contentPane.add(lblNommozo);
			
			lblIDMESA = new JLabel(""+obj.getCodMesa());
			lblIDMESA.setBounds(558, 92, 123, 14);
			contentPane.add(lblIDMESA);		
			
			table.setEnabled(false);	
		
	}
		setLocationRelativeTo(null);
	}
	
	@Override
	public void actionPerformed(ActionEvent arg0) {
		if (arg0.getSource() == btnAgregarProducto) {
			do_btnAgregarProducto_actionPerformed(arg0);
		}
		//System.out.println("PASO POR AQUI MOOUSE CLICKED 1 ");
		
	}
	
	
	
	
	public void mouseClicked(MouseEvent arg0) {
		if (arg0.getSource() == table) {
			do_table_mouseClicked(arg0);
		}	
	}		
		
	protected void do_table_mouseClicked(MouseEvent arg0) {
		System.out.println("ENTRO A MOUSE CLICK");
		
		//private void tableMouseClicked (java.awt.event.MouseEvent evt) {
			
			//PARA OBTENER LA POSICIÓN DONDE DAMOS CLICK x and y 
			int column=table.getColumnModel().getColumnIndexAtX(arg0.getX());
			int row= arg0.getY()/table.getRowHeight();
			 
//			System.out.println("table.getRowCount() "+table.getRowCount());
//			System.out.println("table.getColumnCount()" +table.getColumnCount());
//			System.out.println("table.getColumnModel().getColumnIndexAtX(arg0.getX())" +table.getColumnModel().getColumnIndexAtX(arg0.getX()));
//			System.out.println("arg0.getY()/table.getRowHeight()" +arg0.getY()/table.getRowHeight());
			
			if(row<table.getRowCount() && row>=0 && column<table.getColumnCount() && column>=0){
				
				Object value = table.getValueAt(row, column);
				
				if(value instanceof JButton){
					//si doy click al button
					((JButton) value).doClick();
					//devolvemos la acción
					JButton b= (JButton) value;
					
					//System.out.println("Click en el button");
					if(b.getName().equals("m")){
						System.out.println("ENTRO A MOUSE CLICK  BOTON MODIFICAR");
						System.out.println("Click en el button MODIFICAR");
					}
					if(b.getName().equals("e")){
						System.out.println("ENTRO A MOUSE CLICK  BOTON ELIMINAR");
						System.out.println("Click en el button ELIMINAR");
					}
					
				}			
								
			}		
			
	}
	
	//BUTTON AGREGAR PRODUCTOS AL PEDIDO
	protected void do_btnAgregarProducto_actionPerformed(ActionEvent arg0) {
		
		ProductoBussiness objprod= new ProductoBussiness();
		
		ArrayList<ListaProductosBE> listaProductosBE=objprod.ListaProductos();
		
		FormAgregarProductos fap= new FormAgregarProductos(listaProductosBE,table,lblTotalPagar);
		fap.setVisible(true);
		
		
		
		
		
		
		
		
		
		
		
		
	}

	@Override
	public void mouseEntered(MouseEvent arg0) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void mouseExited(MouseEvent arg0) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void mousePressed(MouseEvent arg0) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void mouseReleased(MouseEvent arg0) {
		// TODO Auto-generated method stub
		
	}
}
	




