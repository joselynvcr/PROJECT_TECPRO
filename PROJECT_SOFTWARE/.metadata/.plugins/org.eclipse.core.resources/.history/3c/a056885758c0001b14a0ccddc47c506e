package saborea.model.bussiness;

import java.util.ArrayList;

import saborea.model.bussiness.DTO.CredencialesBE;
import saborea.model.bussiness.DTO.VwDetallePedidoBE;
import saborea.model.bussiness.DTO.VwRegistroPedidoProductoBE;
import saborea.model.dao.Detalle_PedidoDAO;
import saborea.model.dao.PedidoDAO;
import saborea.model.entities.Detalle_Pedido;
import saborea.model.entities.Pedido;

public class RegistroPedidoProductoBussiness {
	
	
	private PedidoDAO Objpedido;
	private Detalle_PedidoDAO detallepedido;
	
	public RegistroPedidoProductoBussiness() {
		Objpedido=new PedidoDAO();	
		detallepedido=new Detalle_PedidoDAO();
	}
	
	
	
	public ArrayList<VwDetallePedidoBE> findDetallePedidos(ArrayList<Pedido> lista){
		
		Detalle_Pedido dp= new Detalle_Pedido(-1,lista.get(0).getCod_Pedido(),	null, -1,-1,null,-1,-1);
		
		ArrayList<Detalle_Pedido> listaDetalle=detallepedido.buscar(dp, true);		
		
		ArrayList<VwDetallePedidoBE> listaDetallePedidosVW= new ArrayList<VwDetallePedidoBE>();
		
		for(int i=0;i<listaDetalle.size();i++){
			
			listaDetallePedidosVW.add(new VwDetallePedidoBE(
					listaDetalle.get(i).getCodProducto(), 
					listaDetalle.get(i).getObjproducto().getNom_producto(),
					listaDetalle.get(i).getCantidadProductos(), 
					listaDetalle.get(i).getPrecio()	
						)					
					);			
			
		}
		
		return listaDetallePedidosVW;
		
		
	}
	
	
	
	//encontrar pedidos
	public VwRegistroPedidoProductoBE findPedidos(CredencialesBE Cred, int mesa){
		
		Pedido p=new Pedido(-1,	Cred.getEmpleadoId(),null,-1,null,null,	-1,	null,null, 	1,	null, false, false);
		
		ArrayList<Pedido> lista=Objpedido.buscar(p, true);
		
		if(lista==null){
			return null;
		}else{
			VwRegistroPedidoProductoBE PedidoRegistradoVW;
			
			ArrayList<VwDetallePedidoBE> listaDetallePedidosRegistradosVW= findDetallePedidos(lista);
			
			PedidoRegistradoVW = new VwRegistroPedidoProductoBE(
					lista.get(0).getCod_Pedido(),
					Cred.getNombreEmpleado(),
					Cred.getApellidoEmpleado(),
					Cred.getEmpleadoId(),
					lista.get(0).getDniCliente(),
					mesa,
					listaDetallePedidosRegistradosVW
					);
			return PedidoRegistradoVW;
		}
		
		

		
		
		
	}
	
	
	
		
	
	
	
	
	
}
